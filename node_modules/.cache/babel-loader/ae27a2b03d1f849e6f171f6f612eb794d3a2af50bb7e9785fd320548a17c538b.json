{"ast":null,"code":"import BillingDetails from './BillingDetails/BillingDetails.vue';\nimport OrderOverview from './OrderOverview/OrderOverview.vue';\nimport ServerError from 'presentation/components/ServerError/ServerError.vue';\nimport { shallowRef, watch } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport transaltion from './PageCheckout.json';\nimport { useRouter } from 'vue-router';\nimport useCart from 'hooks/useCart';\nimport useCartTools from 'hooks/useCartTools';\nexport default {\n  components: {\n    // CheckoutTopSection,\n    OrderOverview,\n    BillingDetails,\n    ServerError\n  },\n  setup() {\n    const {\n      t\n    } = useI18n({\n      messages: transaltion\n    });\n    const router = useRouter();\n    const shippingMethod = shallowRef(null);\n    const billingAddress = shallowRef(null);\n    const shippingAddress = shallowRef(null);\n    const validBillingForm = shallowRef(false);\n    const validShippingForm = shallowRef(true);\n    const paymentMethod = shallowRef('card');\n    const showError = shallowRef(false);\n    const error = shallowRef(null);\n    const {\n      cart,\n      loading\n    } = useCart();\n    const cartTools = useCartTools();\n    //@todo: what happened to the payment method passed to this?\n    const placeOrder = iData => {\n      if (!validBillingForm.value) {\n        showError.value = true;\n        return Promise.resolve();\n      }\n      showError.value = false;\n      return cartTools.setAddressForCart({\n        billingAddress,\n        shippingAddress\n      }).then(() => {\n        router.push({\n          name: 'pay',\n          //params: { method: paymentMethod.value },\n          params: {\n            method: iData.payMethod,\n            payid: iData.payId\n          }\n        });\n      }).catch(e => {\n        error.value = e;\n      });\n    };\n    watch([cart, loading], ([cart, loading]) => {\n      if (!cart && !loading) {\n        router.replace({\n          path: '/'\n        });\n      }\n    });\n    const setValidBillingForm = valid => {\n      validBillingForm.value = valid;\n    };\n    const setValidShippingForm = valid => {\n      validShippingForm.value = valid;\n    };\n    const updateBilling = billingDetails => {\n      billingAddress.value = JSON.parse(JSON.stringify(billingDetails));\n    };\n    const updateShipping = shippingDetails => {\n      shippingAddress.value = JSON.parse(JSON.stringify(shippingDetails));\n    };\n    const updateShippingMethod = shippingId => {\n      shippingMethod.value = shippingId;\n    };\n    const paymentChanged = payment => {\n      console.log(payment);\n    };\n    return {\n      ...cartTools,\n      placeOrder,\n      shippingMethod,\n      billingAddress,\n      shippingAddress,\n      validBillingForm,\n      validShippingForm,\n      showError,\n      setValidBillingForm,\n      setValidShippingForm,\n      updateBilling,\n      updateShipping,\n      updateShippingMethod,\n      paymentMethod,\n      paymentChanged,\n      error,\n      cart,\n      t\n    };\n  }\n};","map":{"version":3,"names":["BillingDetails","OrderOverview","ServerError","shallowRef","watch","useI18n","transaltion","useRouter","useCart","useCartTools","components","setup","t","messages","router","shippingMethod","billingAddress","shippingAddress","validBillingForm","validShippingForm","paymentMethod","showError","error","cart","loading","cartTools","placeOrder","iData","value","Promise","resolve","setAddressForCart","then","push","name","params","method","payMethod","payid","payId","catch","e","replace","path","setValidBillingForm","valid","setValidShippingForm","updateBilling","billingDetails","JSON","parse","stringify","updateShipping","shippingDetails","updateShippingMethod","shippingId","paymentChanged","payment","console","log"],"sources":["/Users/souvitroy/Downloads/commercetools/ctools/src/presentation/fashion/PageCheckout/PageCheckout.js"],"sourcesContent":["import BillingDetails from './BillingDetails/BillingDetails.vue';\r\nimport OrderOverview from './OrderOverview/OrderOverview.vue';\r\nimport ServerError from 'presentation/components/ServerError/ServerError.vue';\r\nimport { shallowRef, watch } from 'vue';\r\nimport { useI18n } from 'vue-i18n';\r\nimport transaltion from './PageCheckout.json'\r\nimport { useRouter } from 'vue-router';\r\nimport useCart from 'hooks/useCart';\r\nimport useCartTools from 'hooks/useCartTools';\r\n\r\nexport default {\r\n  components: {\r\n    // CheckoutTopSection,\r\n    OrderOverview,\r\n    BillingDetails,\r\n    ServerError,\r\n  },\r\n  setup() {\r\n    const { t } = useI18n({\r\n      messages: transaltion\r\n    });\r\n    const router = useRouter();\r\n    const shippingMethod = shallowRef(null);\r\n    const billingAddress = shallowRef(null);\r\n    const shippingAddress = shallowRef(null);\r\n    const validBillingForm = shallowRef(false);\r\n    const validShippingForm = shallowRef(true);\r\n    const paymentMethod = shallowRef('card');\r\n    const showError = shallowRef(false);\r\n    const error = shallowRef(null);\r\n    const { cart, loading } = useCart();\r\n    const cartTools = useCartTools();\r\n    //@todo: what happened to the payment method passed to this?\r\n    const placeOrder = (iData) => {\r\n      if (!validBillingForm.value) {\r\n        showError.value = true;\r\n        return Promise.resolve();\r\n      }\r\n      showError.value = false;\r\n      return cartTools\r\n        .setAddressForCart({\r\n          billingAddress,\r\n          shippingAddress,\r\n        })\r\n        .then(() => {\r\n          router.push({\r\n            name: 'pay',\r\n            //params: { method: paymentMethod.value },\r\n            params: { method: iData.payMethod, payid: iData.payId },\r\n          });\r\n        })\r\n        .catch((e) => {\r\n          error.value = e;\r\n        });\r\n    };\r\n    watch([cart, loading], ([cart, loading]) => {\r\n      if (!cart && !loading) {\r\n        router.replace({ path: '/' });\r\n      }\r\n    });\r\n    const setValidBillingForm = (valid) => {\r\n      validBillingForm.value = valid;\r\n    };\r\n    const setValidShippingForm = (valid) => {\r\n      validShippingForm.value = valid;\r\n    };\r\n    const updateBilling = (billingDetails) => {\r\n      billingAddress.value = JSON.parse(\r\n        JSON.stringify(billingDetails)\r\n      );\r\n    };\r\n    const updateShipping = (shippingDetails) => {\r\n      shippingAddress.value = JSON.parse(\r\n        JSON.stringify(shippingDetails)\r\n      );\r\n    };\r\n    const updateShippingMethod = (shippingId) => {\r\n      shippingMethod.value = shippingId;\r\n    };\r\n    const paymentChanged = (payment) => {\r\n      console.log(payment)\r\n    };\r\n\r\n    return {\r\n      ...cartTools,\r\n      placeOrder,\r\n      shippingMethod,\r\n      billingAddress,\r\n      shippingAddress,\r\n      validBillingForm,\r\n      validShippingForm,\r\n      showError,\r\n      setValidBillingForm,\r\n      setValidShippingForm,\r\n      updateBilling,\r\n      updateShipping,\r\n      updateShippingMethod,\r\n      paymentMethod,\r\n      paymentChanged,\r\n      error,\r\n      cart,\r\n      t,\r\n    };\r\n  },\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}