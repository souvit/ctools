{"ast":null,"code":"import { computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport useLocale from './useLocale';\nimport useLocation from './useLocation';\nimport useCurrency from './useCurrency';\nimport { ALL } from '../src/constants';\nimport useProducts from './ct/useProducts';\nimport usePaging from './usePaging';\nimport useSearch from './useSearch';\nimport useCustomerTools from './useCustomerTools';\nimport useSelectedChannel from './useSelectedChannel';\n//vue specific useProducts\nexport const useSorts = () => {\n  const route = useRoute();\n  const router = useRouter();\n  const sorts = computed(() => {\n    return route?.query?.sort === 'newest' ? ['lastModifiedAt desc'] : null;\n  });\n  const setSort = sort => router.push({\n    ...route,\n    query: {\n      ...route.query,\n      sort\n    }\n  });\n  return {\n    sorts,\n    setSort\n  };\n};\nexport default (({\n  expand\n} = {}) => {\n  const {\n    customer\n  } = useCustomerTools();\n  const route = useRoute();\n  const {\n    locale\n  } = useLocale();\n  const {\n    location\n  } = useLocation();\n  const currency = useCurrency();\n  const categorySlug = computed(() => route.params.categorySlug === ALL ? null : route.params.categorySlug);\n  const customerGroup = computed(() => customer.value?.customerGroupRef?.customerGroupId);\n  const sku = computed(() => route?.params?.sku);\n  const page = computed(() => route.params.page || 1);\n  const {\n    limit,\n    offset\n  } = usePaging(page);\n  const {\n    sorts,\n    setSort\n  } = useSorts();\n  const {\n    search\n  } = useSearch();\n  const {\n    channel\n  } = useSelectedChannel();\n  const {\n    total,\n    products,\n    loading,\n    error,\n    categoryError\n  } = useProducts({\n    search,\n    limit,\n    offset,\n    locale,\n    currency,\n    sorts,\n    country: location,\n    categorySlug,\n    sku,\n    channel,\n    expand,\n    customerGroup\n  });\n  return {\n    total,\n    products,\n    loading,\n    error,\n    categoryError,\n    sorts,\n    setSort\n  };\n});","map":{"version":3,"names":["computed","useRoute","useRouter","useLocale","useLocation","useCurrency","ALL","useProducts","usePaging","useSearch","useCustomerTools","useSelectedChannel","useSorts","route","router","sorts","query","sort","setSort","push","expand","customer","locale","location","currency","categorySlug","params","customerGroup","value","customerGroupRef","customerGroupId","sku","page","limit","offset","search","channel","total","products","loading","error","categoryError","country"],"sources":["/Users/souvitroy/Downloads/commercetools/ctools/composition/useProducts.js"],"sourcesContent":["import { computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport useLocale from './useLocale';\r\nimport useLocation from './useLocation';\r\nimport useCurrency from './useCurrency';\r\nimport { ALL } from '../src/constants';\r\nimport useProducts from './ct/useProducts';\r\nimport usePaging from './usePaging';\r\nimport useSearch from './useSearch';\r\nimport useCustomerTools from './useCustomerTools';\r\nimport useSelectedChannel from './useSelectedChannel';\r\n//vue specific useProducts\r\nexport const useSorts = () => {\r\n  const route = useRoute();\r\n  const router = useRouter();\r\n  const sorts = computed(() => {\r\n    return route?.query?.sort === 'newest'\r\n      ? ['lastModifiedAt desc']\r\n      : null;\r\n  });\r\n  const setSort = (sort) =>\r\n    router.push({\r\n      ...route,\r\n      query: {\r\n        ...route.query,\r\n        sort,\r\n      },\r\n    });\r\n  return { sorts, setSort };\r\n};\r\n\r\nexport default ({ expand } = {}) => {\r\n  const { customer } = useCustomerTools();\r\n  const route = useRoute();\r\n  const { locale } = useLocale();\r\n  const { location } = useLocation();\r\n  const currency = useCurrency();\r\n  const categorySlug = computed(() =>\r\n    route.params.categorySlug === ALL\r\n      ? null\r\n      : route.params.categorySlug\r\n  );\r\n  const customerGroup = computed(\r\n    () => customer.value?.customerGroupRef?.customerGroupId\r\n  );\r\n  const sku = computed(() => route?.params?.sku);\r\n  const page = computed(() => route.params.page || 1);\r\n  const { limit, offset } = usePaging(page);\r\n  const { sorts, setSort } = useSorts();\r\n  const { search } = useSearch();\r\n  const { channel } = useSelectedChannel();\r\n  const { total, products, loading, error, categoryError } =\r\n    useProducts({\r\n      search,\r\n      limit,\r\n      offset,\r\n      locale,\r\n      currency,\r\n      sorts,\r\n      country: location,\r\n      categorySlug,\r\n      sku,\r\n      channel,\r\n      expand,\r\n      customerGroup,\r\n    });\r\n  return {\r\n    total,\r\n    products,\r\n    loading,\r\n    error,\r\n    categoryError,\r\n    sorts,\r\n    setSort,\r\n  };\r\n};\r\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,KAAK;AAC9B,SAASC,QAAQ,EAAEC,SAAS,QAAQ,YAAY;AAChD,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,WAAW,MAAM,eAAe;AACvC,OAAOC,WAAW,MAAM,eAAe;AACvC,SAASC,GAAG,QAAQ,kBAAkB;AACtC,OAAOC,WAAW,MAAM,kBAAkB;AAC1C,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,OAAOC,kBAAkB,MAAM,sBAAsB;AACrD;AACA,OAAO,MAAMC,QAAQ,GAAG,MAAM;EAC5B,MAAMC,KAAK,GAAGZ,QAAQ,EAAE;EACxB,MAAMa,MAAM,GAAGZ,SAAS,EAAE;EAC1B,MAAMa,KAAK,GAAGf,QAAQ,CAAC,MAAM;IAC3B,OAAOa,KAAK,EAAEG,KAAK,EAAEC,IAAI,KAAK,QAAQ,GAClC,CAAC,qBAAqB,CAAC,GACvB,IAAI;EACV,CAAC,CAAC;EACF,MAAMC,OAAO,GAAID,IAAI,IACnBH,MAAM,CAACK,IAAI,CAAC;IACV,GAAGN,KAAK;IACRG,KAAK,EAAE;MACL,GAAGH,KAAK,CAACG,KAAK;MACdC;IACF;EACF,CAAC,CAAC;EACJ,OAAO;IAAEF,KAAK;IAAEG;EAAQ,CAAC;AAC3B,CAAC;AAED,gBAAe,CAAC;EAAEE;AAAO,CAAC,GAAG,CAAC,CAAC,KAAK;EAClC,MAAM;IAAEC;EAAS,CAAC,GAAGX,gBAAgB,EAAE;EACvC,MAAMG,KAAK,GAAGZ,QAAQ,EAAE;EACxB,MAAM;IAAEqB;EAAO,CAAC,GAAGnB,SAAS,EAAE;EAC9B,MAAM;IAAEoB;EAAS,CAAC,GAAGnB,WAAW,EAAE;EAClC,MAAMoB,QAAQ,GAAGnB,WAAW,EAAE;EAC9B,MAAMoB,YAAY,GAAGzB,QAAQ,CAAC,MAC5Ba,KAAK,CAACa,MAAM,CAACD,YAAY,KAAKnB,GAAG,GAC7B,IAAI,GACJO,KAAK,CAACa,MAAM,CAACD,YAAY,CAC9B;EACD,MAAME,aAAa,GAAG3B,QAAQ,CAC5B,MAAMqB,QAAQ,CAACO,KAAK,EAAEC,gBAAgB,EAAEC,eAAe,CACxD;EACD,MAAMC,GAAG,GAAG/B,QAAQ,CAAC,MAAMa,KAAK,EAAEa,MAAM,EAAEK,GAAG,CAAC;EAC9C,MAAMC,IAAI,GAAGhC,QAAQ,CAAC,MAAMa,KAAK,CAACa,MAAM,CAACM,IAAI,IAAI,CAAC,CAAC;EACnD,MAAM;IAAEC,KAAK;IAAEC;EAAO,CAAC,GAAG1B,SAAS,CAACwB,IAAI,CAAC;EACzC,MAAM;IAAEjB,KAAK;IAAEG;EAAQ,CAAC,GAAGN,QAAQ,EAAE;EACrC,MAAM;IAAEuB;EAAO,CAAC,GAAG1B,SAAS,EAAE;EAC9B,MAAM;IAAE2B;EAAQ,CAAC,GAAGzB,kBAAkB,EAAE;EACxC,MAAM;IAAE0B,KAAK;IAAEC,QAAQ;IAAEC,OAAO;IAAEC,KAAK;IAAEC;EAAc,CAAC,GACtDlC,WAAW,CAAC;IACV4B,MAAM;IACNF,KAAK;IACLC,MAAM;IACNZ,MAAM;IACNE,QAAQ;IACRT,KAAK;IACL2B,OAAO,EAAEnB,QAAQ;IACjBE,YAAY;IACZM,GAAG;IACHK,OAAO;IACPhB,MAAM;IACNO;EACF,CAAC,CAAC;EACJ,OAAO;IACLU,KAAK;IACLC,QAAQ;IACRC,OAAO;IACPC,KAAK;IACLC,aAAa;IACb1B,KAAK;IACLG;EACF,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}